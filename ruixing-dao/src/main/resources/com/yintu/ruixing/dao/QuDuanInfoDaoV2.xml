<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yintu.ruixing.dao.QuDuanInfoDaoV2">
    <resultMap id="BaseResultMap" type="com.yintu.ruixing.entity.QuDuanInfoEntityV2">
        <id column="qiId" jdbcType="INTEGER" property="id"/>
        <result column="cid" jdbcType="INTEGER" property="cid"/>
        <result column="qid" jdbcType="INTEGER" property="qid"/>
        <result column="time" jdbcType="INTEGER" property="time"/>
        <result column="type" jdbcType="INTEGER" property="type"/>
        <result column="data_zhengChang" jdbcType="INTEGER" property="dataZhengchang"/>
        <result column="Design_carrier" jdbcType="VARCHAR" property="designCarrier"/>
        <result column="direction" jdbcType="VARCHAR" property="direction"/>
        <result column="GJcollection" jdbcType="VARCHAR" property="gjcollection"/>
        <result column="V_in_all" jdbcType="DECIMAL" property="vInAll"/>
        <result column="mV_in_zhu" jdbcType="DECIMAL" property="mvInZhu"/>
        <result column="mV_in_bing" jdbcType="DECIMAL" property="mvInBing"/>
        <result column="mV_in_diao_zhu" jdbcType="DECIMAL" property="mvInDiaoZhu"/>
        <result column="mV_in_diao_bing" jdbcType="DECIMAL" property="mvInDiaoBing"/>
        <result column="Hz_in_low_zhu" jdbcType="DECIMAL" property="hzInLowZhu"/>
        <result column="Hz_in_low_bing" jdbcType="DECIMAL" property="hzInLowBing"/>
        <result column="GJ_drive_zhu" jdbcType="INTEGER" property="gjDriveZhu"/>
        <result column="GJ_drive_bing" jdbcType="INTEGER" property="gjDriveBing"/>
        <result column="GJ_rear_collection_zhu" jdbcType="VARCHAR" property="gjRearCollectionZhu"/>
        <result column="GJ_rear_collection_bing" jdbcType="VARCHAR" property="gjRearCollectionBing"/>
        <result column="baojing_zhu" jdbcType="INTEGER" property="baojingZhu"/>
        <result column="baojing_bing" jdbcType="INTEGER" property="baojingBing"/>
        <result column="v31" jdbcType="VARCHAR" property="v31"/>
        <result column="v32" jdbcType="VARCHAR" property="v32"/>
        <result column="v33" jdbcType="VARCHAR" property="v33"/>
        <result column="v34" jdbcType="VARCHAR" property="v34"/>
        <result column="v35" jdbcType="VARCHAR" property="v35"/>
        <result column="v36" jdbcType="VARCHAR" property="v36"/>
        <result column="v37" jdbcType="VARCHAR" property="v37"/>
        <result column="v38" jdbcType="VARCHAR" property="v38"/>
        <result column="v39" jdbcType="VARCHAR" property="v39"/>
        <result column="V_out_zhu" jdbcType="DECIMAL" property="vOutZhu"/>
        <result column="V_out_bei" jdbcType="DECIMAL" property="vOutBei"/>
        <result column="mA_out_zhu" jdbcType="DECIMAL" property="maOutZhu"/>
        <result column="mA_out_bei" jdbcType="DECIMAL" property="maOutBei"/>
        <result column="Hz_up_zhu" jdbcType="DECIMAL" property="hzUpZhu"/>
        <result column="Hz_up_bei" jdbcType="DECIMAL" property="hzUpBei"/>
        <result column="Hz_down_zhu" jdbcType="DECIMAL" property="hzDownZhu"/>
        <result column="Hz_down_bei" jdbcType="DECIMAL" property="hzDownBei"/>
        <result column="Hz_low_zhu" jdbcType="DECIMAL" property="hzLowZhu"/>
        <result column="Hz_low_bei" jdbcType="DECIMAL" property="hzLowBei"/>
        <result column="FBJ_drive_zhu" jdbcType="INTEGER" property="fbjDriveZhu"/>
        <result column="FBJ_drive_bei" jdbcType="INTEGER" property="fbjDriveBei"/>
        <result column="FBJ_collection_zhu" jdbcType="VARCHAR" property="fbjCollectionZhu"/>
        <result column="FBJ_collection_bei" jdbcType="VARCHAR" property="fbjCollectionBei"/>
        <result column="V_songduan_Cable" jdbcType="DECIMAL" property="vSongduanCable"/>
        <result column="mA_songduan_Cable" jdbcType="DECIMAL" property="maSongduanCable"/>
        <result column="V_shouduan_Cable_host" jdbcType="DECIMAL" property="vShouduanCableHost"/>
        <result column="V_shouduan_Cable_spare" jdbcType="DECIMAL" property="vShouduanCableSpare"/>
        <result column="mA_shouduan_Cable" jdbcType="DECIMAL" property="maShouduanCable"/>
        <result column="mA_Cable_JBP" jdbcType="DECIMAL" property="maCableJbp"/>
        <result column="A_longIn_JBP" jdbcType="DECIMAL" property="aLonginJbp"/>
        <result column="A_longOut_JBP" jdbcType="DECIMAL" property="aLongoutJbp"/>
        <result column="A_shortIn_JBP" jdbcType="DECIMAL" property="aShortinJbp"/>
        <result column="A_shortOut_JBP" jdbcType="DECIMAL" property="aShortoutJbp"/>
        <result column="T_JBP" jdbcType="INTEGER" property="tJbp"/>
        <result column="mA_Cable_FBP" jdbcType="DECIMAL" property="maCableFbp"/>
        <result column="A_longIn_FBP" jdbcType="DECIMAL" property="aLonginFbp"/>
        <result column="A_longOut_FBP" jdbcType="DECIMAL" property="aLongoutFbp"/>
        <result column="A_shortIn_FBP" jdbcType="DECIMAL" property="aShortinFbp"/>
        <result column="A_shortOut_FBP" jdbcType="DECIMAL" property="aShortoutFbp"/>
        <result column="T_FBP" jdbcType="INTEGER" property="tFbp"/>
        <result column="A_longIn_FBA_zhu" jdbcType="DECIMAL" property="aLonginFbaZhu"/>
        <result column="A_longIn_FBA_diao" jdbcType="DECIMAL" property="aLonginFbaDiao"/>
        <result column="A_longOut_FBA_zhu" jdbcType="DECIMAL" property="aLongoutFbaZhu"/>
        <result column="A_longOut_FBA_diao" jdbcType="DECIMAL" property="aLongoutFbaDiao"/>
        <result column="A_shortIn_FBA_zhu" jdbcType="DECIMAL" property="aShortinFbaZhu"/>
        <result column="A_shortIn_FBA_diao" jdbcType="DECIMAL" property="aShortinFbaDiao"/>
        <result column="A_shortOut_FBA_zhu" jdbcType="DECIMAL" property="aShortoutFbaZhu"/>
        <result column="A_shortOut_FBA_diao" jdbcType="DECIMAL" property="aShortoutFbaDiao"/>
        <result column="A_longIn_JBA_zhu" jdbcType="DECIMAL" property="aLonginJbaZhu"/>
        <result column="A_longIn_JBA_diao" jdbcType="DECIMAL" property="aLonginJbaDiao"/>
        <result column="A_longOut_JBA_zhu" jdbcType="DECIMAL" property="aLongoutJbaZhu"/>
        <result column="A_longOut_JBA_diao" jdbcType="DECIMAL" property="aLongoutJbaDiao"/>
        <result column="A_shortIn_JBA_zhu" jdbcType="DECIMAL" property="aShortinJbaZhu"/>
        <result column="A_shortIn_JBA_diao" jdbcType="DECIMAL" property="aShortinJbaDiao"/>
        <result column="A_shortOut_JBA_zhu" jdbcType="DECIMAL" property="aShortoutJbaZhu"/>
        <result column="A_shortOut_JBA_diao" jdbcType="DECIMAL" property="aShortoutJbaDiao"/>
        <result column="A_shortOut_JBA_diao" jdbcType="DECIMAL" property="aShortoutJbaDiao"/>
        <result column="rackAddress" jdbcType="VARCHAR" property="yuliu"/>
        <result column="yuliu" jdbcType="VARCHAR" property="yuliu"/>
        <association column="qid" jdbcType="INTEGER" property="quDuanBaseEntity">
            <id column="qbId" jdbcType="INTEGER" property="id"/>
            <result column="quDuanYunYing_name" jdbcType="VARCHAR" property="quduanyunyingName"/>
        </association>
    </resultMap>
    <sql id="Base_Column_List">
        qi.id as qiId, msg_id, send_num, createtime as time, station_id as cid, qi.type,v1 as qbId, v2 as data_zhengChang,

    v3 as V_out_zhu , v4 as mA_out_zhu,  v5 as Hz_up_zhu,  v6 as Hz_down_zhu,  v7 as Hz_low_zhu,  v8 as FBJ_drive_zhu,
    v9 as V_out_bei, v10 as mA_out_bei, v11 as Hz_up_bei, v12 as Hz_down_bei, v13 as Hz_low_bei, v14 as FBJ_drive_bei,


   v15 as V_songduan_Cable, v16 as mA_songduan_Cable,
   v17 as V_shouduan_Cable_host, v18 as V_shouduan_Cable_spare, v19 as mA_shouduan_Cable,


   v20 as V_in_all,   v21 as mV_in_zhu,  v22 as mV_in_diao_zhu,  v23 as Hz_in_low_zhu,   v24 as GJ_drive_zhu, v25 as baojing_zhu,
                      v26 as mV_in_bing, v27 as mV_in_diao_bing, v28 as Hz_in_low_bing,  v29 as GJ_drive_bing,v30 as baojing_bing,

    v31,v32,v33, v34, v35, v36, v37, v38, v39,     v40 as direction , v41 as signalPosition,




   v42 as mA_Cable_FBP, v43 as A_longIn_FBP, v44 as A_longOut_FBP, v45 as A_shortIn_FBP, v46 as A_shortOut_FBP, v52 as T_FBP,


   v54 as A_longIn_FBA_zhu, v55 as A_longOut_FBA_zhu, v56 as A_shortIn_FBA_zhu, v57 as A_shortOut_FBA_zhu,
   v58 as A_longIn_FBA_diao, v59 as A_longOut_FBA_diao, v60 as A_shortIn_FBA_diao, v61 as A_shortOut_FBA_diao,

   v62 as A_longIn_JBA_zhu, v63 as A_longOut_JBA_zhu, v64 as A_shortIn_JBA_zhu,v65 as A_shortOut_JBA_zhu,
   v66 as A_longIn_JBA_diao, v67 as A_longOut_JBA_diao, v68 as A_shortIn_JBA_diao, v69 as A_shortOut_JBA_diao,


   v47 as mA_Cable_JBP, v48 as A_longIn_JBP, v49 as A_longOut_JBP, v50 as A_shortIn_JBP, v51 as A_shortOut_JBP,  v53 as T_JBP,

    v70 as rackAddress , v71, v72, v73, v74, v75, v76,v77, v78,
    qb.id as qbId,
    qb.quDuanYunYing_name
    </sql>


    <!--车站id 查询车站内电码化的信息-->
    <select id="findGuZhangKuData" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        SELECT qi.*,
               qb.*
        FROM mro_quduan_info qi,
             mro_quduan_base qb
        WHERE qi.qid = qb.id
          AND qi.id = #{id,jdbcType=INTEGER}
    </select>
    <!--

        &lt;!&ndash;根据日期  查询对应的数据&ndash;&gt;&lt;!&ndash;错误&ndash;&gt;
        <select id="findQuDuanDataByTime" resultMap="BaseResultMap">
            SELECT qi.*
            FROM mro_quduan_info qi,
                 mro_quduan_base qd
            WHERE qi.qid = qd.id
              AND DATE(qi.time) = DATE(#{time,jdbcType=TIMESTAMP})

        </select>
        &lt;!&ndash;根据查询日期的24个时间  查询对应的数据   &ndash;&gt; &lt;!&ndash;错误&ndash;&gt;
        <select id="findQuDuanDataByTime2" resultType="java.lang.Integer" statementType="STATEMENT">
            SELECT ${name}
            FROM mro_quduan_info qi,
                 mro_quduan_base qd
            WHERE qi.qid = qd.id
              AND DATE_FORMAT(qi.time, "%Y/%m/%d %H:%i:%S") = DATE_FORMAT("${format}", "%Y/%m/%d %H:%i:%S")

        </select>
    -->

    <!--根据传来的时间段和区段名和属性名 按秒来 查询对应的数据   -->
    <select id="findQuDuanData" resultType="java.lang.Integer" statementType="STATEMENT">
        select ${shuxingname}
        from data_applydata qi,
             mro_quduan_base qb
        where qi.v1 = qb.qdid
          and qb.quDuanYunYing_name = "${quduanname}"
          and qi.v1="${qdid}"
          and qi.createtime
            BETWEEN
            "${starttime}"
            and
            "${endtime}"
    </select>

    <resultMap id="quduanBaseResultMap" type="com.yintu.ruixing.entity.QuDuanInfoEntityV2">
        <id column="qiId" jdbcType="INTEGER" property="id"/>
        <result column="xid" jdbcType="INTEGER" property="xid"/>
        <result column="qid" jdbcType="INTEGER" property="qid"/>
        <result column="cid" jdbcType="INTEGER" property="cid"/>
        <result column="sid" jdbcType="INTEGER" property="sid"/>
        <result column="typeid" jdbcType="INTEGER" property="typeid"/>
        <result column="data_zhengChang" jdbcType="INTEGER" property="dataZhengchang"/>
        <result column="Design_carrier" jdbcType="VARCHAR" property="designCarrier"/>
        <result column="direction" jdbcType="VARCHAR" property="direction"/>
        <result column="GJcollection" jdbcType="VARCHAR" property="gjcollection"/>
        <result column="V_in_all" jdbcType="INTEGER" property="vInAll"/>
        <result column="mV_in_zhu" jdbcType="INTEGER" property="mvInZhu"/>
        <result column="mV_in_bing" jdbcType="INTEGER" property="mvInBing"/>
        <result column="mV_in_diao_zhu" jdbcType="INTEGER" property="mvInDiaoZhu"/>
        <result column="mV_in_diao_bing" jdbcType="INTEGER" property="mvInDiaoBing"/>
        <result column="Hz_in_low_zhu" jdbcType="INTEGER" property="hzInLowZhu"/>
        <result column="Hz_in_low_bing" jdbcType="INTEGER" property="hzInLowBing"/>
        <result column="GJ_drive_zhu" jdbcType="VARCHAR" property="gjDriveZhu"/>
        <result column="GJ_drive_bing" jdbcType="VARCHAR" property="gjDriveBing"/>
        <result column="GJ_rear_collection_zhu" jdbcType="VARCHAR" property="gjRearCollectionZhu"/>
        <result column="GJ_rear_collection_bing" jdbcType="VARCHAR" property="gjRearCollectionBing"/>
        <result column="baojing_zhu" jdbcType="VARCHAR" property="baojingZhu"/>
        <result column="baojing_bing" jdbcType="VARCHAR" property="baojingBing"/>
        <result column="V_out_zhu" jdbcType="INTEGER" property="vOutZhu"/>
        <result column="V_out_bei" jdbcType="INTEGER" property="vOutBei"/>
        <result column="mA_out_zhu" jdbcType="INTEGER" property="maOutZhu"/>
        <result column="mA_out_bei" jdbcType="INTEGER" property="maOutBei"/>
        <result column="Hz_up_zhu" jdbcType="INTEGER" property="hzUpZhu"/>
        <result column="Hz_up_bei" jdbcType="INTEGER" property="hzUpBei"/>
        <result column="Hz_down_zhu" jdbcType="INTEGER" property="hzDownZhu"/>
        <result column="Hz_down_bei" jdbcType="INTEGER" property="hzDownBei"/>
        <result column="Hz_low_zhu" jdbcType="INTEGER" property="hzLowZhu"/>
        <result column="Hz_low_bei" jdbcType="INTEGER" property="hzLowBei"/>
        <result column="FBJ_drive_zhu" jdbcType="VARCHAR" property="fbjDriveZhu"/>
        <result column="FBJ_drive_bei" jdbcType="VARCHAR" property="fbjDriveBei"/>
        <result column="FBJ_collection_zhu" jdbcType="VARCHAR" property="fbjCollectionZhu"/>
        <result column="FBJ_collection_bei" jdbcType="VARCHAR" property="fbjCollectionBei"/>
        <result column="V_songduan_Cable" jdbcType="INTEGER" property="vSongduanCable"/>
        <result column="mA_songduan_Cable" jdbcType="INTEGER" property="maSongduanCable"/>
        <result column="V_shouduan_Cable_host" jdbcType="INTEGER" property="vShouduanCableHost"/>
        <result column="V_shouduan_Cable_spare" jdbcType="INTEGER" property="vShouduanCableSpare"/>
        <result column="mA_shouduan_Cable" jdbcType="INTEGER" property="maShouduanCable"/>
        <result column="mA_Cable_JBP" jdbcType="INTEGER" property="maCableJbp"/>
        <result column="A_longIn_JBP" jdbcType="INTEGER" property="aLonginJbp"/>
        <result column="A_longOut_JBP" jdbcType="INTEGER" property="aLongoutJbp"/>
        <result column="A_shortIn_JBP" jdbcType="INTEGER" property="aShortinJbp"/>
        <result column="A_shortOut_JBP" jdbcType="INTEGER" property="aShortoutJbp"/>
        <result column="T_JBP" jdbcType="INTEGER" property="tJbp"/>
        <result column="mA_Cable_FBP" jdbcType="INTEGER" property="maCableFbp"/>
        <result column="A_longIn_FBP" jdbcType="INTEGER" property="aLonginFbp"/>
        <result column="A_longOut_FBP" jdbcType="INTEGER" property="aLongoutFbp"/>
        <result column="A_shortIn_FBP" jdbcType="INTEGER" property="aShortinFbp"/>
        <result column="A_shortOut_FBP" jdbcType="INTEGER" property="aShortoutFbp"/>
        <result column="T_FBP" jdbcType="INTEGER" property="tFbp"/>
        <result column="A_longIn_FBA_zhu" jdbcType="INTEGER" property="aLonginFbaZhu"/>
        <result column="A_longIn_FBA_diao" jdbcType="INTEGER" property="aLonginFbaDiao"/>
        <result column="A_longOut_FBA_zhu" jdbcType="INTEGER" property="aLongoutFbaZhu"/>
        <result column="A_longOut_FBA_diao" jdbcType="INTEGER" property="aLongoutFbaDiao"/>
        <result column="A_shortIn_FBA_zhu" jdbcType="INTEGER" property="aShortinFbaZhu"/>
        <result column="A_shortIn_FBA_diao" jdbcType="INTEGER" property="aShortinFbaDiao"/>
        <result column="A_shortOut_FBA_zhu" jdbcType="INTEGER" property="aShortoutFbaZhu"/>
        <result column="A_shortOut_FBA_diao" jdbcType="INTEGER" property="aShortoutFbaDiao"/>
        <result column="A_longIn_JBA_zhu" jdbcType="INTEGER" property="aLonginJbaZhu"/>
        <result column="A_longIn_JBA_diao" jdbcType="INTEGER" property="aLonginJbaDiao"/>
        <result column="A_longOut_JBA_zhu" jdbcType="INTEGER" property="aLongoutJbaZhu"/>
        <result column="A_longOut_JBA_diao" jdbcType="INTEGER" property="aLongoutJbaDiao"/>
        <result column="A_shortIn_JBA_zhu" jdbcType="INTEGER" property="aShortinJbaZhu"/>
        <result column="A_shortIn_JBA_diao" jdbcType="INTEGER" property="aShortinJbaDiao"/>
        <result column="A_shortOut_JBA_zhu" jdbcType="INTEGER" property="aShortoutJbaZhu"/>
        <result column="A_shortOut_JBA_diao" jdbcType="INTEGER" property="aShortoutJbaDiao"/>
        <result column="qiYuliu" jdbcType="VARCHAR" property="yuliu"/>
        <association column="sid" jdbcType="INTEGER" property="sheBeiEntity">
            <result column="sb_name" jdbcType="VARCHAR" property="sbName"/>
        </association>
        <association column="qid" jdbcType="INTEGER" property="quDuanBaseEntity">
            <result column="typeid" jdbcType="VARCHAR" property="typeid"/>
        </association>
    </resultMap>
    <select id="findDianMaHuaDatabById" resultMap="quduanBaseResultMap" parameterType="java.lang.Integer">
        SELECT qb. typeid ,
              /* qi.Design_carrier,*/
               qi.v3 V_out_zhu,
               qi.v9 V_out_bei,
               qi.v4 mA_out_zhu,
        SELECT qb.typeid,
               qi.Design_carrier,
               qi.v3  V_out_zhu,
               qi.v9  V_out_bei,
               qi.v4  mA_out_zhu,
               qi.v10 mA_out_bei,
               qi.v5  Hz_up_zhu,
               qi.v11 Hz_up_bei,
               qi.v6  Hz_down_zhu,
               qi.v12 Hz_down_bei,
               qi.v7  Hz_low_zhu,
               qi.v13 Hz_low_bei,
               qi.v8  FBJ_drive_zhu,
               qi.v14 FBJ_drive_bei,
               /*qi.FBJ_collection_zhu,
               qi.FBJ_collection_bei,*/
               sb.sb_name
        FROM data_applydata qi,
             mro_shebei sb,
             mro_quduan_base qb
        WHERE sb.id = qb.sid
          AND qi.v1 = qb.qdid
          AND qi.v1 = #{id}
        GROUP BY sb.sb_name
    </select>


    <!--按照id查询-->
    <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from data_applydata qi right outer join mro_quduan_base qb on
        qi.v1 = qb.qdid and qi.station_id = qb.cz_id
        where qi.id = #{id,jdbcType=INTEGER}
    </select>

    <!--按照车站查询一条区段详情-->
    <select id="selectLastByCzId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from data_applydata qi right outer join mro_quduan_base qb on
        qi.v1 = qb.qdid and qi.station_id = qb.cz_id
        <where>
            <if test="czId!=null">
                qb.cz_id=#{czId,jdbcType=INTEGER}
            </if>
        </where>
        order by qi.createtime DESC limit 1
    </select>
    <!--查询车站以及时间区间查询详情-->
    <select id="selectByCzIdAndTime" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from data_applydata qi right outer join mro_quduan_base qb on
        qi.v1 = qb.qdid and qi.station_id = qb.cz_id
        <where>
            <if test="czId!=null">
                qb.cz_id=#{czId,jdbcType=INTEGER}
            </if>
            <if test="startTime!=null and endTime!=null">
                and FROM_UNIXTIME(qi.createtime) between #{startTime,jdbcType=TIMESTAMP} and #{endTime,jdbcType=TIMESTAMP}
            </if>
        </where>
        order by qb.id ASC
    </select>
    <!--按照区段id查询一条详情(数据分析)-->
    <select id="selectLastByQid" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from data_applydata qi right outer join mro_quduan_base qb on
        qi.v1 = qb.qdid and qi.station_id = qb.cz_id
        <where>
            <if test="qid!=null">
                qb.id=#{qid,jdbcType=INTEGER}
            </if>
        </where>
        order by qi.createtime DESC limit 1
    </select>


    <!--实时报表-->
    <select id="selectByCzIdAndQid" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        FROM data_applydata qi inner join mro_quduan_base qb on
        qi.v1 = qb.qdid and qi.station_id = qb.cz_id
        <where>
            <if test="czId!=null">
                qi.station_id=#{czId,jdbcType=INTEGER}
            </if>
            <if test="time!=null">
                and DATE(FROM_UNIXTIME(qi.createtime)) = DATE(#{time,jdbcType=TIMESTAMP})
            </if>
        </where>
    </select>


    <resultMap id="StatisticsResultMap" type="Map">

        <result column="max_V_out_zhu" jdbcType="INTEGER" property="maxVOutZhu"/>
        <result column="min_V_out_zhu" jdbcType="INTEGER" property="minVOutZhu"/>
        <result column="max_mA_out_zhu" jdbcType="INTEGER" property="maxMAOutZhu"/>
        <result column="min_mA_out_zhu" jdbcType="INTEGER" property="minMAOutZhu"/>
        <result column="max_V_out_bei" jdbcType="INTEGER" property="maxVOutBei"/>
        <result column="min_V_out_bei" jdbcType="INTEGER" property="minVOutBei"/>
        <result column="max_mA_out_bei" jdbcType="INTEGER" property="maxMAOutBei"/>
        <result column="min_mA_out_bei" jdbcType="INTEGER" property="minMAOutBei"/>

        <result column="max_V_songduan_Cable" jdbcType="INTEGER" property="maxVSongduanCable"/>
        <result column="min_V_songduan_Cable" jdbcType="INTEGER" property="minVSongduanCable"/>
        <result column="max_mA_songduan_Cable" jdbcType="INTEGER" property="maxMASongduanCable"/>
        <result column="min_mA_songduan_Cable" jdbcType="INTEGER" property="minMASongduanCable"/>


        <result column="max_V_shouduan_Cable_host" jdbcType="INTEGER" property="maxVShouduanCableHost"/>
        <result column="min_shouduan_Cable_host" jdbcType="INTEGER" property="minVShouduanCableHost"/>
        <result column="max_V_shouduan_Cable_spare" jdbcType="INTEGER" property="maxVShouduanCableSpare"/>
        <result column="min_V_shouduan_Cable_spare" jdbcType="INTEGER" property="minVShouduanCableSpare"/>
        <result column="max_mA_shouduan_Cable" jdbcType="INTEGER" property="maxMAShouduanCable"/>
        <result column="min_mA_shouduan_Cable" jdbcType="INTEGER" property="minMAShouduanCable"/>

        <result column="max_V_in_all" jdbcType="INTEGER" property="maxVInAll"/>
        <result column="min_V_in_all" jdbcType="INTEGER" property="minVInAll"/>
        <result column="max_mV_in_zhu" jdbcType="INTEGER" property="maxMVInZhu"/>
        <result column="min_mV_in_zhu" jdbcType="INTEGER" property="minMVInZhu"/>
        <result column="max_mV_in_diao_zhu" jdbcType="INTEGER" property="maxMVInDiaoZhu"/>
        <result column="min_mV_in_diao_zhu" jdbcType="INTEGER" property="minMVInDiaoZhu"/>

        <result column="quDuanYunYing_name" jdbcType="VARCHAR" property="quDuanYunYingName"/>
    </resultMap>
    <sql id="Statistics__Column_List">
        MAX(qi.v3) AS max_V_out_zhu,
        MIN(qi.v3) AS min_V_out_zhu,
        MAX(qi.v4) AS max_mA_out_zhu,
        MIN(qi.v4) AS min_mA_out_zhu,
        MAX(qi.v9) AS max_V_out_bei,
        MIN(qi.v9) AS min_V_out_bei,
        MAX(qi.v10) AS max_mA_out_bei,
        MIN(qi.v10) AS min_mA_out_bei,

       MAX( qi.v15 ) AS max_V_songduan_Cable,
	   MIN( qi.v15 ) AS min_V_songduan_Cable,
	   MAX( qi.v16 ) AS max_mA_songduan_Cable,
	   MIN( qi.v16 ) AS min_mA_songduan_Cable,

       MAX( qi.v17 ) AS max_V_shouduan_Cable_host,
	   MIN( qi.v17 ) AS min_shouduan_Cable_host,
	   MAX( qi.v18 ) AS max_V_shouduan_Cable_spare,
	   MIN( qi.v18 ) AS min_V_shouduan_Cable_spare,
	   MAX( qi.v19 ) AS max_mA_shouduan_Cable,
	   MIN( qi.v19 ) AS min_mA_shouduan_Cable,

       MAX( qi.v20 ) AS max_V_in_all,
	   MIN( qi.v20 ) AS min_V_in_all,

	   MAX( qi.v21 ) AS max_mV_in_zhu,
	   MIN( qi.v21 ) AS min_mV_in_zhu,
	   MAX( qi.v22 ) AS max_mV_in_diao_zhu,
	   MIN( qi.v22 ) AS min_mV_in_diao_zhu,
       qb.quDuanYunYing_name
    </sql>
    <!--日报表-->
    <select id="selectStatisticsByCzIdAndTime" resultMap="StatisticsResultMap">
        SELECT
        <include refid="Statistics__Column_List"/>
        FROM data_applydata qi inner join mro_quduan_base qb on
        qi.v1 = qb.qdid and qi.station_id = qb.cz_id
        <where>
            <if test="czId != null">
                qi.station_id=#{czId,jdbcType=INTEGER}
            </if>
            <if test="time !=null ">
                and DATE(FROM_UNIXTIME(qi.createtime))=DATE(#{time,jdbcType=TIMESTAMP})
            </if>
        </where>
        GROUP BY
        qi.station_id,qi.v1
    </select>
</mapper>